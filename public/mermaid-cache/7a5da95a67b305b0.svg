<svg id="mermaid-1771938076822" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 6435.0234375px;" viewBox="0 0 6435.0234375 505.140625" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#mermaid-1771938076822{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-1771938076822 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-1771938076822 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-1771938076822 .error-icon{fill:#552222;}#mermaid-1771938076822 .error-text{fill:#552222;stroke:#552222;}#mermaid-1771938076822 .edge-thickness-normal{stroke-width:1px;}#mermaid-1771938076822 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1771938076822 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1771938076822 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-1771938076822 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1771938076822 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1771938076822 .marker{fill:#666;stroke:#666;}#mermaid-1771938076822 .marker.cross{stroke:#666;}#mermaid-1771938076822 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1771938076822 p{margin:0;}#mermaid-1771938076822 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-1771938076822 .cluster-label text{fill:#333;}#mermaid-1771938076822 .cluster-label span{color:#333;}#mermaid-1771938076822 .cluster-label span p{background-color:transparent;}#mermaid-1771938076822 .label text,#mermaid-1771938076822 span{fill:#000000;color:#000000;}#mermaid-1771938076822 .node rect,#mermaid-1771938076822 .node circle,#mermaid-1771938076822 .node ellipse,#mermaid-1771938076822 .node polygon,#mermaid-1771938076822 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1771938076822 .rough-node .label text,#mermaid-1771938076822 .node .label text,#mermaid-1771938076822 .image-shape .label,#mermaid-1771938076822 .icon-shape .label{text-anchor:middle;}#mermaid-1771938076822 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-1771938076822 .rough-node .label,#mermaid-1771938076822 .node .label,#mermaid-1771938076822 .image-shape .label,#mermaid-1771938076822 .icon-shape .label{text-align:center;}#mermaid-1771938076822 .node.clickable{cursor:pointer;}#mermaid-1771938076822 .root .anchor path{fill:#666!important;stroke-width:0;stroke:#666;}#mermaid-1771938076822 .arrowheadPath{fill:#333333;}#mermaid-1771938076822 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1771938076822 .flowchart-link{stroke:#666;fill:none;}#mermaid-1771938076822 .edgeLabel{background-color:white;text-align:center;}#mermaid-1771938076822 .edgeLabel p{background-color:white;}#mermaid-1771938076822 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1771938076822 .labelBkg{background-color:rgba(255, 255, 255, 0.5);}#mermaid-1771938076822 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1771938076822 .cluster text{fill:#333;}#mermaid-1771938076822 .cluster span{color:#333;}#mermaid-1771938076822 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1771938076822 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#000000;}#mermaid-1771938076822 rect.text{fill:none;stroke-width:0;}#mermaid-1771938076822 .icon-shape,#mermaid-1771938076822 .image-shape{background-color:white;text-align:center;}#mermaid-1771938076822 .icon-shape p,#mermaid-1771938076822 .image-shape p{background-color:white;padding:2px;}#mermaid-1771938076822 .icon-shape rect,#mermaid-1771938076822 .image-shape rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1771938076822 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-1771938076822 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-1771938076822 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="mermaid-1771938076822_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-1771938076822_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-1771938076822_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-1771938076822_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-1771938076822_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-1771938076822_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M6084.044,203.57L6019.577,231.332C5955.11,259.094,5826.176,314.617,5761.709,347.879C5697.242,381.141,5697.242,392.141,5697.242,397.641L5697.242,403.141" id="L_Detection_D1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Detection_D1_0" data-points="W3sieCI6NjA4NC4wNDQwNDAwMjQ1MTksInkiOjIwMy41NzAzMTI1fSx7IngiOjU2OTcuMjQyMTg3NSwieSI6MzcwLjE0MDYyNX0seyJ4Ijo1Njk3LjI0MjE4NzUsInkiOjQwNy4xNDA2MjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M6125.78,203.57L6104.227,231.332C6082.674,259.094,6039.567,314.617,6018.014,347.879C5996.461,381.141,5996.461,392.141,5996.461,397.641L5996.461,403.141" id="L_Detection_D2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Detection_D2_0" data-points="W3sieCI6NjEyNS43ODAzMjc3MTA2OCwieSI6MjAzLjU3MDMxMjV9LHsieCI6NTk5Ni40NjA5Mzc1LCJ5IjozNzAuMTQwNjI1fSx7IngiOjU5OTYuNDYwOTM3NSwieSI6NDA3LjE0MDYyNX1d" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M6167.704,203.57L6189.257,231.332C6210.811,259.094,6253.917,314.617,6275.47,345.879C6297.023,377.141,6297.023,384.141,6297.023,387.641L6297.023,391.141" id="L_Detection_D3_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Detection_D3_0" data-points="W3sieCI6NjE2Ny43MDQwNDcyODkzMiwieSI6MjAzLjU3MDMxMjV9LHsieCI6NjI5Ny4wMjM0Mzc1LCJ5IjozNzAuMTQwNjI1fSx7IngiOjYyOTcuMDIzNDM3NSwieSI6Mzk1LjE0MDYyNX1d" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_Detection_D1_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Detection_D2_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Detection_D3_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="root" transform="translate(0, 0)"><g class="clusters"><g class="cluster " id="RBCD" data-look="classic"><rect style="" x="8" y="8" width="2342.828125" height="337.140625"></rect><g class="cluster-label " transform="translate(1079.4140625, 8)"><foreignObject width="200" height="72"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel "><p>Resource-Based Constrained Delegation - MOST FLEXIBLE</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M279.375,176.57L285.625,176.57C291.875,176.57,304.375,176.57,316.208,176.57C328.042,176.57,339.208,176.57,344.792,176.57L350.375,176.57" id="L_R1_R2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R1_R2_0" data-points="W3sieCI6Mjc5LjM3NSwieSI6MTc2LjU3MDMxMjV9LHsieCI6MzE2Ljg3NSwieSI6MTc2LjU3MDMxMjV9LHsieCI6MzU0LjM3NSwieSI6MTc2LjU3MDMxMjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M689.547,176.57L695.797,176.57C702.047,176.57,714.547,176.57,726.38,176.57C738.214,176.57,749.38,176.57,754.964,176.57L760.547,176.57" id="L_R2_R3_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R2_R3_0" data-points="W3sieCI6Njg5LjU0Njg3NSwieSI6MTc2LjU3MDMxMjV9LHsieCI6NzI3LjA0Njg3NSwieSI6MTc2LjU3MDMxMjV9LHsieCI6NzY0LjU0Njg3NSwieSI6MTc2LjU3MDMxMjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1031.688,176.57L1039.826,176.57C1047.964,176.57,1064.24,176.57,1079.849,176.57C1095.458,176.57,1110.401,176.57,1117.872,176.57L1125.344,176.57" id="L_R3_R4_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R3_R4_0" data-points="W3sieCI6MTAzMS42ODc1LCJ5IjoxNzYuNTcwMzEyNX0seyJ4IjoxMDgwLjUxNTYyNSwieSI6MTc2LjU3MDMxMjV9LHsieCI6MTEyOS4zNDM3NSwieSI6MTc2LjU3MDMxMjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1356.391,176.57L1362.641,176.57C1368.891,176.57,1381.391,176.57,1393.224,176.57C1405.057,176.57,1416.224,176.57,1421.807,176.57L1427.391,176.57" id="L_R4_R5_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R4_R5_0" data-points="W3sieCI6MTM1Ni4zOTA2MjUsInkiOjE3Ni41NzAzMTI1fSx7IngiOjEzOTMuODkwNjI1LCJ5IjoxNzYuNTcwMzEyNX0seyJ4IjoxNDMxLjM5MDYyNSwieSI6MTc2LjU3MDMxMjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1661.5,176.57L1667.75,176.57C1674,176.57,1686.5,176.57,1698.333,176.57C1710.167,176.57,1721.333,176.57,1726.917,176.57L1732.5,176.57" id="L_R5_R6_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R5_R6_0" data-points="W3sieCI6MTY2MS41LCJ5IjoxNzYuNTcwMzEyNX0seyJ4IjoxNjk5LCJ5IjoxNzYuNTcwMzEyNX0seyJ4IjoxNzM2LjUsInkiOjE3Ni41NzAzMTI1fV0=" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1978.438,176.57L1984.688,176.57C1990.938,176.57,2003.438,176.57,2015.271,176.57C2027.104,176.57,2038.271,176.57,2043.854,176.57L2049.438,176.57" id="L_R6_R7_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_R6_R7_0" data-points="W3sieCI6MTk3OC40Mzc1LCJ5IjoxNzYuNTcwMzEyNX0seyJ4IjoyMDE1LjkzNzUsInkiOjE3Ni41NzAzMTI1fSx7IngiOjIwNTMuNDM3NSwieSI6MTc2LjU3MDMxMjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_R1_R2_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_R2_R3_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1080.515625, 176.5703125)"><g class="label" data-id="L_R3_R4_0" transform="translate(-11.328125, -12)"><foreignObject width="22.65625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>Yes</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_R4_R5_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_R5_R6_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_R6_R7_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-R1-26" transform="translate(162.4375, 176.5703125)"><rect class="basic label-container" style="" x="-116.9375" y="-39" width="233.875" height="78"></rect><g class="label" style="" transform="translate(-86.9375, -24)"><rect></rect><foreignObject width="173.875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Target resource controls<br>who can delegate</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-R2-28" transform="translate(521.9609375, 176.5703125)"><rect class="basic label-container" style="" x="-167.5859375" y="-51" width="335.171875" height="102"></rect><g class="label" style="" transform="translate(-137.5859375, -36)"><rect></rect><foreignObject width="275.171875" height="72"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel "><p>msDS-AllowedToActOnBehalfOfOtherIdentity<br>attribute on target</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-R3-30" transform="translate(898.1171875, 176.5703125)"><polygon points="133.5703125,0 267.140625,-133.5703125 133.5703125,-267.140625 0,-133.5703125" class="label-container" transform="translate(-133.0703125, 133.5703125)" style="fill:#99ccff !important"></polygon><g class="label" style="" transform="translate(-94.5703125, -24)"><rect></rect><foreignObject width="189.140625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Attacker has GenericWrite<br>on target computer?</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-R4-32" transform="translate(1242.8671875, 176.5703125)"><rect class="basic label-container" style="" x="-113.5234375" y="-39" width="227.046875" height="78"></rect><g class="label" style="" transform="translate(-83.5234375, -24)"><rect></rect><foreignObject width="167.046875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Add controlled account<br>to delegation attribute</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-R5-34" transform="translate(1546.4453125, 176.5703125)"><rect class="basic label-container" style="" x="-115.0546875" y="-39" width="230.109375" height="78"></rect><g class="label" style="" transform="translate(-85.0546875, -24)"><rect></rect><foreignObject width="170.109375" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Request S4U2Self ticket<br>for any user</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-R6-36" transform="translate(1857.46875, 176.5703125)"><rect class="basic label-container" style="" x="-120.96875" y="-39" width="241.9375" height="78"></rect><g class="label" style="" transform="translate(-90.96875, -24)"><rect></rect><foreignObject width="181.9375" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Request S4U2Proxy ticket<br>for target service</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-R7-38" transform="translate(2183.3828125, 176.5703125)"><rect class="basic label-container" style="fill:#6699ff !important" x="-129.9453125" y="-39" width="259.890625" height="78"></rect><g class="label" style="" transform="translate(-99.9453125, -24)"><rect></rect><foreignObject width="199.890625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Impersonate privileged user<br>on target resource</p></span></div></foreignObject></g></g></g></g><g class="root" transform="translate(2392.828125, 46.6328125)"><g class="clusters"><g class="cluster " id="Constrained" data-look="classic"><rect style="" x="8" y="8" width="1732.40625" height="243.875"></rect><g class="cluster-label " transform="translate(774.203125, 8)"><foreignObject width="200" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel "><p>Constrained Delegation - MORE SECURE</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M300.906,129.938L307.156,129.938C313.406,129.938,325.906,129.938,337.74,129.938C349.573,129.938,360.74,129.938,366.323,129.938L371.906,129.938" id="L_C1_C2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C1_C2_0" data-points="W3sieCI6MzAwLjkwNjI1LCJ5IjoxMjkuOTM3NX0seyJ4IjozMzguNDA2MjUsInkiOjEyOS45Mzc1fSx7IngiOjM3NS45MDYyNSwieSI6MTI5LjkzNzV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M603.438,129.938L609.688,129.938C615.938,129.938,628.438,129.938,640.271,129.938C652.104,129.938,663.271,129.938,668.854,129.938L674.438,129.938" id="L_C2_C3_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C2_C3_0" data-points="W3sieCI6NjAzLjQzNzUsInkiOjEyOS45Mzc1fSx7IngiOjY0MC45Mzc1LCJ5IjoxMjkuOTM3NX0seyJ4Ijo2NzguNDM3NSwieSI6MTI5LjkzNzV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M887.906,129.938L894.156,129.938C900.406,129.938,912.906,129.938,924.74,129.938C936.573,129.938,947.74,129.938,953.323,129.938L958.906,129.938" id="L_C3_C4_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C3_C4_0" data-points="W3sieCI6ODg3LjkwNjI1LCJ5IjoxMjkuOTM3NX0seyJ4Ijo5MjUuNDA2MjUsInkiOjEyOS45Mzc1fSx7IngiOjk2Mi45MDYyNSwieSI6MTI5LjkzNzV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1136.781,129.938L1144.919,129.938C1153.057,129.938,1169.333,129.938,1184.943,129.938C1200.552,129.938,1215.495,129.938,1222.966,129.938L1230.438,129.938" id="L_C4_C5_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C4_C5_0" data-points="W3sieCI6MTEzNi43ODEyNSwieSI6MTI5LjkzNzV9LHsieCI6MTE4NS42MDkzNzUsInkiOjEyOS45Mzc1fSx7IngiOjEyMzQuNDM3NSwieSI6MTI5LjkzNzV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1446.938,129.938L1453.188,129.938C1459.438,129.938,1471.938,129.938,1483.771,129.938C1495.604,129.938,1506.771,129.938,1512.354,129.938L1517.938,129.938" id="L_C5_C6_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_C5_C6_0" data-points="W3sieCI6MTQ0Ni45Mzc1LCJ5IjoxMjkuOTM3NX0seyJ4IjoxNDg0LjQzNzUsInkiOjEyOS45Mzc1fSx7IngiOjE1MjEuOTM3NSwieSI6MTI5LjkzNzV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_C1_C2_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_C2_C3_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_C3_C4_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1185.609375, 129.9375)"><g class="label" data-id="L_C4_C5_0" transform="translate(-11.328125, -12)"><foreignObject width="22.65625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>Yes</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_C5_C6_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-C1-13" transform="translate(173.203125, 129.9375)"><rect class="basic label-container" style="" x="-127.703125" y="-39" width="255.40625" height="78"></rect><g class="label" style="" transform="translate(-97.703125, -24)"><rect></rect><foreignObject width="195.40625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Service configured with<br>msDS-AllowedToDelegateTo</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-C2-15" transform="translate(489.671875, 129.9375)"><rect class="basic label-container" style="fill:#ffcc99 !important" x="-113.765625" y="-39" width="227.53125" height="78"></rect><g class="label" style="" transform="translate(-83.765625, -24)"><rect></rect><foreignObject width="167.53125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Lists specific SPNs<br>service can delegate to</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-C3-17" transform="translate(783.171875, 129.9375)"><rect class="basic label-container" style="" x="-104.734375" y="-39" width="209.46875" height="78"></rect><g class="label" style="" transform="translate(-74.734375, -24)"><rect></rect><foreignObject width="149.46875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Service requests TGS<br>for allowed SPN only</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-C4-19" transform="translate(1049.84375, 129.9375)"><polygon points="86.9375,0 173.875,-86.9375 86.9375,-173.875 0,-86.9375" class="label-container" transform="translate(-86.4375, 86.9375)"></polygon><g class="label" style="" transform="translate(-47.9375, -24)"><rect></rect><foreignObject width="95.875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Attacker gets<br>service hash?</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-C5-21" transform="translate(1340.6875, 129.9375)"><rect class="basic label-container" style="" x="-106.25" y="-39" width="212.5" height="78"></rect><g class="label" style="" transform="translate(-76.25, -24)"><rect></rect><foreignObject width="152.5" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Forge TGS for<br>allowed services only</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-C6-23" transform="translate(1612.421875, 129.9375)"><rect class="basic label-container" style="fill:#ff9966 !important" x="-90.484375" y="-39" width="180.96875" height="78"></rect><g class="label" style="" transform="translate(-60.484375, -24)"><rect></rect><foreignObject width="120.96875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Limited lateral<br>movement scope</p></span></div></foreignObject></g></g></g></g><g class="root" transform="translate(4175.234375, 14.90625)"><g class="clusters"><g class="cluster " id="Unconstrained" data-look="classic"><rect style="" x="8" y="8" width="1816.640625" height="307.328125"></rect><g class="cluster-label " transform="translate(816.3203125, 8)"><foreignObject width="200" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel "><p>Unconstrained Delegation - LEAST SECURE</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M260.359,161.664L266.609,161.664C272.859,161.664,285.359,161.664,297.193,161.664C309.026,161.664,320.193,161.664,325.776,161.664L331.359,161.664" id="L_U1_U2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_U1_U2_0" data-points="W3sieCI6MjYwLjM1OTM3NSwieSI6MTYxLjY2NDA2MjV9LHsieCI6Mjk3Ljg1OTM3NSwieSI6MTYxLjY2NDA2MjV9LHsieCI6MzM1LjM1OTM3NSwieSI6MTYxLjY2NDA2MjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M526.766,161.664L533.016,161.664C539.266,161.664,551.766,161.664,563.599,161.664C575.432,161.664,586.599,161.664,592.182,161.664L597.766,161.664" id="L_U2_U3_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_U2_U3_0" data-points="W3sieCI6NTI2Ljc2NTYyNSwieSI6MTYxLjY2NDA2MjV9LHsieCI6NTY0LjI2NTYyNSwieSI6MTYxLjY2NDA2MjV9LHsieCI6NjAxLjc2NTYyNSwieSI6MTYxLjY2NDA2MjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M837.156,161.664L843.406,161.664C849.656,161.664,862.156,161.664,873.99,161.664C885.823,161.664,896.99,161.664,902.573,161.664L908.156,161.664" id="L_U3_U4_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_U3_U4_0" data-points="W3sieCI6ODM3LjE1NjI1LCJ5IjoxNjEuNjY0MDYyNX0seyJ4Ijo4NzQuNjU2MjUsInkiOjE2MS42NjQwNjI1fSx7IngiOjkxMi4xNTYyNSwieSI6MTYxLjY2NDA2MjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1149.484,161.664L1157.622,161.664C1165.76,161.664,1182.036,161.664,1197.646,161.664C1213.255,161.664,1228.198,161.664,1235.669,161.664L1243.141,161.664" id="L_U4_U5_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_U4_U5_0" data-points="W3sieCI6MTE0OS40ODQzNzUsInkiOjE2MS42NjQwNjI1fSx7IngiOjExOTguMzEyNSwieSI6MTYxLjY2NDA2MjV9LHsieCI6MTI0Ny4xNDA2MjUsInkiOjE2MS42NjQwNjI1fV0=" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path><path d="M1476.875,161.664L1483.125,161.664C1489.375,161.664,1501.875,161.664,1513.708,161.664C1525.542,161.664,1536.708,161.664,1542.292,161.664L1547.875,161.664" id="L_U5_U6_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_U5_U6_0" data-points="W3sieCI6MTQ3Ni44NzUsInkiOjE2MS42NjQwNjI1fSx7IngiOjE1MTQuMzc1LCJ5IjoxNjEuNjY0MDYyNX0seyJ4IjoxNTUxLjg3NSwieSI6MTYxLjY2NDA2MjV9XQ==" marker-end="url(#mermaid-1771938076822_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_U1_U2_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_U2_U3_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_U3_U4_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1198.3125, 161.6640625)"><g class="label" data-id="L_U4_U5_0" transform="translate(-11.328125, -12)"><foreignObject width="22.65625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>Yes</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_U5_U6_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-U1-0" transform="translate(152.9296875, 161.6640625)"><rect class="basic label-container" style="" x="-107.4296875" y="-39" width="214.859375" height="78"></rect><g class="label" style="" transform="translate(-77.4296875, -24)"><rect></rect><foreignObject width="154.859375" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>User authenticates to<br>Service with UCD</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-U2-2" transform="translate(431.0625, 161.6640625)"><rect class="basic label-container" style="" x="-95.703125" y="-39" width="191.40625" height="78"></rect><g class="label" style="" transform="translate(-65.703125, -24)"><rect></rect><foreignObject width="131.40625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>User's TGT stored<br>in service memory</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-U3-4" transform="translate(719.4609375, 161.6640625)"><rect class="basic label-container" style="fill:#ff9999 !important" x="-117.6953125" y="-39" width="235.390625" height="78"></rect><g class="label" style="" transform="translate(-87.6953125, -24)"><rect></rect><foreignObject width="175.390625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Service can impersonate<br>user to ANY service</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-U4-6" transform="translate(1030.8203125, 161.6640625)"><polygon points="118.6640625,0 237.328125,-118.6640625 118.6640625,-237.328125 0,-118.6640625" class="label-container" transform="translate(-118.1640625, 118.6640625)"></polygon><g class="label" style="" transform="translate(-79.6640625, -24)"><rect></rect><foreignObject width="159.328125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Attacker compromises<br>service?</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-U5-8" transform="translate(1362.0078125, 161.6640625)"><rect class="basic label-container" style="" x="-114.8671875" y="-27" width="229.734375" height="54"></rect><g class="label" style="" transform="translate(-84.8671875, -12)"><rect></rect><foreignObject width="169.734375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Extract TGT from LSASS</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-U6-10" transform="translate(1669.5078125, 161.6640625)"><rect class="basic label-container" style="fill:#ff4444 !important" x="-117.6328125" y="-39" width="235.265625" height="78"></rect><g class="label" style="" transform="translate(-87.6328125, -24)"><rect></rect><foreignObject width="175.265625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Full domain compromise<br>if DA authenticates</p></span></div></foreignObject></g></g></g></g><g class="node default  " id="flowchart-Detection-41" transform="translate(6146.7421875, 176.5703125)"><rect class="basic label-container" style="" x="-96.8671875" y="-27" width="193.734375" height="54"></rect><g class="label" style="" transform="translate(-66.8671875, -12)"><rect></rect><foreignObject width="133.734375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Detection Methods</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-D1-43" transform="translate(5697.2421875, 446.140625)"><rect class="basic label-container" style="" x="-128.65625" y="-39" width="257.3125" height="78"></rect><g class="label" style="" transform="translate(-98.65625, -24)"><rect></rect><foreignObject width="197.3125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Event ID 4769: TGS Request<br>with delegation flags</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-D2-45" transform="translate(5996.4609375, 446.140625)"><rect class="basic label-container" style="" x="-120.5625" y="-39" width="241.125" height="78"></rect><g class="label" style="" transform="translate(-90.5625, -24)"><rect></rect><foreignObject width="181.125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Monitor msDS-AllowedTo*<br>attribute changes</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-D3-47" transform="translate(6297.0234375, 446.140625)"><rect class="basic label-container" style="" x="-130" y="-51" width="260" height="102"></rect><g class="label" style="" transform="translate(-100, -36)"><rect></rect><foreignObject width="200" height="72"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel "><p>Unusual S4U2Self/S4U2Proxy<br>ticket requests</p></span></div></foreignObject></g></g></g></g></g></svg>